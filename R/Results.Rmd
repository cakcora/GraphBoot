---
title: "results"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## GraphBoot R Scripts

Working on the results of the GraphBoot Spark code:

```{r}
library(ggplot2)
library(plyr)
library(igraph)

rm(list=ls(all=TRUE))


vis<-function(resultFolder,fileVal,dataset){
  fName<- paste(resultFolder,fileVal,".txt",sep="")
  
  ex <- read.table(file=fName, header=TRUE,sep="\t")
  effect<-ddply(ex,.(seed),summarise,V1=mean(mean/avgGraphDeg),V2=mean(varianceOfBootStrapDegrees),V3=mean(lmsiDistinct))
  
  effect<-cbind(effect,dataset)
  
  return(effect)
}
vals =c("orange","blue", "green")
resultFolder<-"C:/Users/cxa123230/IdeaProjects/GraphBoot/results/"
o1<-vis(resultFolder,"expenron" ,"Enron")
o11<-vis(resultFolder,"expenronDirected" ,"EnronD")
o2<-vis(resultFolder,"expDBLP" ,"Dblp")
o3<-vis(resultFolder,"expfacebook" ,"Facebook")
o4<-vis(resultFolder,"expepinions" ,"Epinions")
o41<-vis(resultFolder,"expepinionsDirected" ,"EpinionsD")
o5<-vis(resultFolder,"expwiki" ,"Wiki")
o51<-vis(resultFolder,"expwikiDirected" ,"WikiD")

df<-data.frame(o1)
#df<-rbind(df,o11)
df<-rbind(df,o2)
df<-rbind(df,o3)
df<-rbind(df,o4)
#df<-rbind(df,o41)
df<-rbind(df,o5)
#df<-rbind(df,o51)
lt<-c(1, 2,3, 4,5,6,7,8)

m11<-ggplot(df, aes(x=seed,y =V1, color=dataset, group=dataset))   
m11<-m11+ geom_line(size=2)+scale_y_continuous(limits=c(0,1.6),name=expression(paste(bar(x)," / ",mu)))
m11<-m11+ theme(legend.position = c(0.8, 0.8),text = element_text(size=16)) 
m11<-m11+ geom_point(aes(shape=dataset), size=4) +scale_shape_manual(values=c(0,1,2,3,4)) 
m11

m12<-ggplot(df, aes(x=seed,y =V2, color=dataset, group=dataset)) 
m12<-m12+ geom_line(size=2)+scale_y_log10(name=expression("Variance in bootstraps"))  
m12<-m12+ theme(legend.position = c(0.8, 0.8),text = element_text(size=16))+scale_linetype_manual(values=lt)
m12<-m12+geom_point(aes(shape=dataset), size=4) +scale_shape_manual(values=c(0,1,2,3,4)) 
m12
 

ggsave(filename=paste(resultFolder,"figs/results.eps",sep=""),plot=m11,width=6,height=4,unit="in")

```








